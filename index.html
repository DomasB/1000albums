<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>1000 albums challange</title>
    <style media="screen">
      #app {
        max-width:1500px;
        margin:0 auto;
      }
      .artist-image {
        display:inline-block;
        width:300px;
        height:300px;
        vertical-align: top;
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
<script type="text/javascript">
  let data;
  document.addEventListener('scroll', (e) => {
    let windowHeight = document.getElementById('app').getBoundingClientRect().height;
    let scrollHeight = window.scrollY;
    if (windowHeight - scrollHeight < 1600) {
      let dataToDraw = data.slice(0,40);
      data = data.slice(40)
      drawImage(dataToDraw);
    }
  })
  fetch('data.json')
  .then(r => r.json())
  .then(r => {
    data = r.slice(40);
    drawImage(r.slice(0,40));
  })
  const drawImage = (imageArray) => {
    Promise.all(
      imageArray.map(artist => {
        return fetch(artist.artist_image).then(r => {
          let containerDiv = documment.createElement('div');
          containerDiv.classList.add('artist-container');
          let titleDiv = document.createElement('div');
          titleDiv.classList.add('artist-title');
          titleDiv.innerHTML = artist.artist_name;
          let image = document.createElement('img');
          image.src = r.ok ? artist.artist_image : 'empty.png';
          image.classList.add("artist-image");
          containerDiv.appendChild(image);
          containerDiv.appendChild(titleDiv);
          document.getElementById('app').appendChild(containerDiv);
        })
      })
    )
  }

</script>
  </body>
</html>
